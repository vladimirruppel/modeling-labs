# -*- coding: utf-8 -*-
"""
Конфигурация и константы для ЛР №8
"""

from pathlib import Path
from enum import Enum

# ============================================================================
# ПУТИ
# ============================================================================

DATA_DIR = Path(__file__).parent / 'data'
OUTPUT_DIR = Path(__file__).parent / 'output'

# Создать директории, если не существуют
DATA_DIR.mkdir(parents=True, exist_ok=True)
OUTPUT_DIR.mkdir(parents=True, exist_ok=True)

# ============================================================================
# ПАРАМЕТРЫ ВАРИАНТА 18
# ============================================================================

VARIANT = 18
LAMBDA_VARIANT18 = 0.4  # машин/мин (24 в час)

# Конфигурации для варианта 18
VARIANT18_CONFIGS = {
    1: {
        'id': 1,
        'n_channels': 1,
        'm_queue': float('inf'),
        'mu': 0.5,
        'description': '1 служащий, 2 мин обслуживание',
        'employees': 1
    },
    2: {
        'id': 2,
        'n_channels': 1,
        'm_queue': float('inf'),
        'mu': 0.8,
        'description': '2 служащих, 1.25 мин обслуживание',
        'employees': 2
    },
    3: {
        'id': 3,
        'n_channels': 2,
        'm_queue': float('inf'),
        'mu': 0.5,
        'description': '2 канала, 2 мин обслуживание каждый',
        'employees': 2
    }
}

# ============================================================================
# ПАРАМЕТРЫ СИМУЛЯЦИИ ПО УМОЛЧАНИЮ
# ============================================================================

DEFAULT_T = 10000                  # Интервал моделирования (минуты)
DEFAULT_N_REALIZATIONS = 100       # Число реализаций для Монте-Карло
DEFAULT_EPSILON = 0.01             # Допустимая ошибка для валидации
DEFAULT_SEED = 18                  # Начальное значение для random
QUEUE_LIMIT = 100                  # Ограничение очереди для симуляции

# ============================================================================
# ПЕРЕЧИСЛЕНИЯ
# ============================================================================

class DistributionType(Enum):
    """Типы распределений"""
    EXPONENTIAL = 'exponential'
    WEIBULL = 'weibull'
    GAMMA = 'gamma'
    NORMAL = 'normal'

class EventType(Enum):
    """Типы событий в симуляции"""
    ARRIVAL = 'arrival'
    END_SERVICE = 'end_service'

# ============================================================================
# ПАРАМЕТРЫ РАСПРЕДЕЛЕНИЙ
# ============================================================================

# Параметры для Вейбула (подобраны для соответствия экспоненциальному)
WEIBULL_PARAMS = {
    'arrival': {'a': 2.0, 'b': 2.5},      # для λ ≈ 0.4
    'service': {'a': 1.5, 'b': 2.0}       # для μ ≈ 0.5
}

# Параметры для Гамма-распределения
GAMMA_PARAMS = {
    'arrival': {'lambda': 0.4, 'eta': 2},
    'service': {'lambda': 0.5, 'eta': 3}
}

# Параметры для Нормального распределения
NORMAL_PARAMS = {
    'arrival': {'m': 2.5, 'sigma': 0.5},    # 1/0.4 = 2.5
    'service': {'m': 2.0, 'sigma': 0.3}     # 1/0.5 = 2.0
}

# ============================================================================
# ПАРАМЕТРЫ ВИЗУАЛИЗАЦИИ
# ============================================================================

CHART_DPI = 150
CHART_FORMAT = 'png'
CHART_FIGSIZE = (12, 8)
CHART_FIGSIZE_SMALL = (10, 6)
CHART_FIGSIZE_LARGE = (14, 10)

# Цвета для графиков
COLOR_THEORETICAL = '#1f77b4'  # Синий
COLOR_SIMULATED = '#ff7f0e'    # Оранжевый
COLOR_ERROR = '#d62728'        # Красный
COLOR_IDLE = '#ffff00'         # Жёлтый

# ============================================================================
# ТЕКСТЫ ИНТЕРФЕЙСА (на русском)
# ============================================================================

MENU_TITLE = "ЛР 8: Моделирование немарковских СМО (Метод Монте-Карло)"

MENU_OPTIONS = {
    1: "Быстрый старт: Вариант 18 (экспоненциальное распределение)",
    2: "Вариант 18: Полный анализ всех конфигураций",
    3: "Настраиваемое моделирование",
    4: "Сравнение распределений",
    5: "Анализ сходимости (оптимальное N)",
    6: "Валидация с ЛР №7",
    7: "Визуализация результатов",
    8: "Настройки симуляции",
    9: "Выход"
}

DISTRIBUTION_NAMES = {
    DistributionType.EXPONENTIAL: 'Экспоненциальное',
    DistributionType.WEIBULL: 'Вейбула',
    DistributionType.GAMMA: 'Гамма-распределение',
    DistributionType.NORMAL: 'Нормальное (Гауссовское)'
}

# ============================================================================
# СООБЩЕНИЯ И ПОДСКАЗКИ
# ============================================================================

MESSAGES = {
    'welcome': f'Добро пожаловать в программу ЛР №8 (Вариант {VARIANT})',
    'simulation_start': 'Начало моделирования...',
    'simulation_complete': 'Моделирование завершено',
    'validation_ok': 'Валидация: ✓ Результаты адекватны',
    'validation_fail': 'Валидация: ✗ Результаты отклоняются от теории',
    'error': 'Ошибка:',
    'warning': 'Предупреждение:',
    'success': 'Успешно:',
}

# ============================================================================
# КРИТЕРИИ ВАЛИДАЦИИ
# ============================================================================

VALIDATION_CRITERIA = {
    'probability_sum_tolerance': 0.01,      # |Σp_i - 1.0| < 0.01
    'characteristic_tolerance': 0.01,       # |simulated - theoretical| < 0.01
    'max_error_tolerance': 0.05,           # Максимальная ошибка < 5%
}

# ============================================================================
# СЕРИАЛИЗАЦИЯ И ФОРМАТИРОВАНИЕ
# ============================================================================

PRECISION_PROBABILITY = 6          # Знаков после запятой для вероятностей
PRECISION_CHARACTERISTIC = 4       # Знаков после запятой для характеристик
PRECISION_TIME = 3                 # Знаков после запятой для времён
